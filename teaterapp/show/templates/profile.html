{% extends "base.html" %}
{% load show_extras %}

{% block body %}
    
    <h4>Profil</h4>
    <table class="table table-bordered table-striped table-hover">

        <tr>
            <td>
                Navn:
            </td>
            <td>
                {{ profile.name }}
            </td>
        </tr>
        <tr>
            <td>
                Alder:
            </td>
            <td>
                {{ profile.birth|timesince }}
            </td>
        </tr>
        <tr>
            <td>
                Køn:
            </td>
            <td>
                {{ profile|gender }}
            </td>
        </tr>
        <tr>
            <td>
                Låst:
            </td>
            <td>
                {% if profile.locked %}
                    Locked
                {% else %}
                    Not locked
                {% endif %}
            </td>
        </tr>
    </table>

    <h4>Skalaer:</h4>
    <table class="table table-bordered table-striped table-hover">
        {% for r in profile.rating_set.all %}
        <tr>
            <td>
                {{ r.scale.name }}
            </td>
            <td>
                <form method="post" id="form" class="form-horizontal" role="form">
                    {% csrf_token %}
                    <input type="hidden" name="profile" value="{{ profile.id }}">
                    <input type="hidden" name="scale" value="{{ r.scale.id }}">
                    <INPUT type="submit" value="-" name="action"  class="btn btn-primary"> 
                    {{ r.value }}    
                    <INPUT type="submit" value="+" name="action"  class="btn btn-primary"> 
                </form>

                
            </td>
        </tr>
        {% endfor %}
    </table>

    <h4>Noter:</h4>
    <table class="table table-bordered table-striped table-hover">
        <tr>
            <td>
                Dato
            </td>
            <td>
                Tekst
            </td>
        </tr>
        {% for n in profile.notes.all %}
        <tr>
            <td>
                {{ n.date }}
            </td>
            <td>
                {{ n.text }}
            </td>
        </tr>
        {% endfor %}
    </table>

    <h4>Nuværende rum:</h4>
    {% if profile.location %}
        {{ profile.location.name }}
    {% else %}
        Ingen
    {% endif %}
    <br>


    <h4>Næste mulige rum:</h4>
    <table class="table table-bordered table-striped table-hover">
        <tr>
            <td>
                Lokation
            </td>
            <td>
                Score
            </td>
        </tr>

        {% for l in next %}
        <tr>
            <td>
                {{ l.name }}
            </td>
            <td>
                {{ l|getscore:profile }}
            </td>
        </tr>
        {% endfor %}
    </table>
    





    <a href="/">Tilbage</a>

{% endblock %}


{% block javascript %}
    //Check version periodically
    var intervalID = setInterval(
        function()
        { 
            $.get('/profile/{{profile.id}}/version/', 
                function(data)
                { 
                    if(data.version != {{profile.version}})
                        window.location.reload(); 
                },'json');
        }, 5000);
{% endblock %}



